[{"line":1,"elements":[{"line":3,"name":"","description":"","type":"background","keyword":"Background","steps":[{"name":"url demoBaseUrl","result":{"duration":8803,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"Given","line":5},{"name":"path 'greeting', 'reset'","result":{"duration":47596809,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":6},{"name":"method get","result":{"duration":7503944,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"When","line":7,"doc_string":{"content_type":"","value":"11:04:59.460 request:\n1 > GET http:\/\/127.0.0.1:51918\/greeting\/reset\n1 > Accept-Encoding: gzip,deflate\n1 > Connection: Keep-Alive\n1 > Host: 127.0.0.1:51918\n1 > User-Agent: Apache-HttpClient\/4.5.5 (Java\/1.8.0_181)\n\n11:04:59.464 response time in milliseconds: 4.14\n1 < 200\n1 < Cache-Control: no-cache, no-store, max-age=0, must-revalidate\n1 < Content-Length: 14\n1 < Content-Type: text\/plain;charset=UTF-8\n1 < Date: Tue, 09 Apr 2019 14:04:59 GMT\n1 < Expires: 0\n1 < Pragma: no-cache\n1 < X-Content-Type-Options: nosniff\n1 < X-Frame-Options: DENY\n1 < X-XSS-Protection: 1; mode=block\n{ counter: 0 }","line":7}},{"name":"status 200","result":{"duration":4566,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"Then","line":8},{"name":"match response == { counter: 0 }","result":{"duration":193837,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":9},{"name":"def waitUntil =","result":{"duration":9076551,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":12,"doc_string":{"content_type":"","value":"function(x) {\n  while (true) {\n    var result = karate.call('get.feature');\n    var greeting = result.response;\n    karate.log('poll response', greeting); \/\/<\n    if (greeting.id >= x) {\n      karate.log('condition satisfied, exiting');\n      return;\n    }\n    karate.log('sleeping');\n    \/\/ uncomment \/ modify the sleep time as per your wish\n    \/\/ java.lang.Thread.sleep(1000);\n  }\n}","line":12}}]},{"line":30,"name":"get greeting and keep polling until id is n + 5","description":"using javascript, and a second feature","id":"get-greeting-and-keep-polling-until-id-is-n-+-5","type":"scenario","keyword":"Scenario","steps":[{"name":"def result = call read('get.feature')","result":{"duration":86618537,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":32},{"name":"get.feature","result":{"duration":0,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"","line":32},{"name":"configure report = false","result":{"duration":2723670,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> *","line":5},{"name":"url demoBaseUrl","result":{"duration":10744,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> Given","line":6},{"name":"path 'greeting'","result":{"duration":108943,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> And","line":7},{"name":"method get","result":{"duration":7466074,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> When","line":8},{"name":"status 200","result":{"duration":5068,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> Then","line":9},{"name":"def current = result.response","result":{"duration":5884321,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":33},{"name":"print 'current: ' + current","result":{"duration":5833174,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":34,"doc_string":{"content_type":"","value":"11:04:59.573 [print] current: {id=1, content=Hello World!}","line":34}},{"name":"def target = current.id + 5","result":{"duration":4977362,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":35},{"name":"call waitUntil target","result":{"duration":379886345,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":36,"doc_string":{"content_type":"","value":"11:04:59.654 poll response {id=2, content=Hello World!} \n11:04:59.666 sleeping \n11:04:59.689 poll response {id=3, content=Hello World!} \n11:04:59.689 sleeping \n11:04:59.722 poll response {id=4, content=Hello World!} \n11:04:59.722 sleeping \n11:04:59.774 poll response {id=1, content=Hello World!} \n11:04:59.776 sleeping \n11:04:59.799 poll response {id=3, content=Hello World!} \n11:04:59.800 sleeping \n11:04:59.868 poll response {id=5, content=Hello World!} \n11:04:59.868 sleeping \n11:04:59.951 poll response {id=6, content=Hello World!} \n11:04:59.958 condition satisfied, exiting","line":36}},{"name":"get.feature","result":{"duration":0,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"","line":36},{"name":"configure report = false","result":{"duration":106723,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> *","line":5},{"name":"url demoBaseUrl","result":{"duration":8062,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> Given","line":6},{"name":"path 'greeting'","result":{"duration":85692,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> And","line":7},{"name":"method get","result":{"duration":33328826,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> When","line":8},{"name":"status 200","result":{"duration":4562,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> Then","line":9},{"name":"get.feature","result":{"duration":0,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"","line":36},{"name":"configure report = false","result":{"duration":124594,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> *","line":5},{"name":"url demoBaseUrl","result":{"duration":7901,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> Given","line":6},{"name":"path 'greeting'","result":{"duration":94689,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> And","line":7},{"name":"method get","result":{"duration":11454059,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> When","line":8},{"name":"status 200","result":{"duration":6582,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> Then","line":9},{"name":"get.feature","result":{"duration":0,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"","line":36},{"name":"configure report = false","result":{"duration":98383,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> *","line":5},{"name":"url demoBaseUrl","result":{"duration":7051,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> Given","line":6},{"name":"path 'greeting'","result":{"duration":87161,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> And","line":7},{"name":"method get","result":{"duration":6171455,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> When","line":8},{"name":"status 200","result":{"duration":4785,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> Then","line":9},{"name":"get.feature","result":{"duration":0,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"","line":36},{"name":"configure report = false","result":{"duration":107002,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> *","line":5},{"name":"url demoBaseUrl","result":{"duration":6649,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> Given","line":6},{"name":"path 'greeting'","result":{"duration":80294,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> And","line":7},{"name":"method get","result":{"duration":10852064,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> When","line":8},{"name":"status 200","result":{"duration":3478,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> Then","line":9},{"name":"get.feature","result":{"duration":0,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"","line":36},{"name":"configure report = false","result":{"duration":1018753,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> *","line":5},{"name":"url demoBaseUrl","result":{"duration":8108,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> Given","line":6},{"name":"path 'greeting'","result":{"duration":135169,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> And","line":7},{"name":"method get","result":{"duration":6756868,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> When","line":8},{"name":"status 200","result":{"duration":4760,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> Then","line":9},{"name":"get.feature","result":{"duration":0,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"","line":36},{"name":"configure report = false","result":{"duration":162931,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> *","line":5},{"name":"url demoBaseUrl","result":{"duration":11871,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> Given","line":6},{"name":"path 'greeting'","result":{"duration":87516,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> And","line":7},{"name":"method get","result":{"duration":7844684,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> When","line":8},{"name":"status 200","result":{"duration":4384,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> Then","line":9},{"name":"get.feature","result":{"duration":0,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"","line":36},{"name":"configure report = false","result":{"duration":142731,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> *","line":5},{"name":"url demoBaseUrl","result":{"duration":8309,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> Given","line":6},{"name":"path 'greeting'","result":{"duration":101129,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> And","line":7},{"name":"method get","result":{"duration":56544101,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> When","line":8},{"name":"status 200","result":{"duration":4046,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"> Then","line":9}]},{"line":3,"name":"","description":"","type":"background","keyword":"Background","steps":[{"name":"url demoBaseUrl","result":{"duration":9876,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"Given","line":5},{"name":"path 'greeting', 'reset'","result":{"duration":3198407,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":6},{"name":"method get","result":{"duration":7189634,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"When","line":7,"doc_string":{"content_type":"","value":"11:04:59.765 request:\n1 > GET http:\/\/127.0.0.1:51918\/greeting\/reset\n1 > Accept-Encoding: gzip,deflate\n1 > Connection: Keep-Alive\n1 > Host: 127.0.0.1:51918\n1 > User-Agent: Apache-HttpClient\/4.5.5 (Java\/1.8.0_181)\n\n11:04:59.770 response time in milliseconds: 3.84\n1 < 200\n1 < Cache-Control: no-cache, no-store, max-age=0, must-revalidate\n1 < Content-Length: 14\n1 < Content-Type: text\/plain;charset=UTF-8\n1 < Date: Tue, 09 Apr 2019 14:04:59 GMT\n1 < Expires: 0\n1 < Pragma: no-cache\n1 < X-Content-Type-Options: nosniff\n1 < X-Frame-Options: DENY\n1 < X-XSS-Protection: 1; mode=block\n{ counter: 0 }","line":7}},{"name":"status 200","result":{"duration":4693,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"Then","line":8},{"name":"match response == { counter: 0 }","result":{"duration":184915,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":9},{"name":"def waitUntil =","result":{"duration":87692,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":12,"doc_string":{"content_type":"","value":"function(x) {\n  while (true) {\n    var result = karate.call('get.feature');\n    var greeting = result.response;\n    karate.log('poll response', greeting); \/\/<\n    if (greeting.id >= x) {\n      karate.log('condition satisfied, exiting');\n      return;\n    }\n    karate.log('sleeping');\n    \/\/ uncomment \/ modify the sleep time as per your wish\n    \/\/ java.lang.Thread.sleep(1000);\n  }\n}","line":12}}]},{"line":38,"name":"using the karate retry syntax","description":"","id":"using-the-karate-retry-syntax","type":"scenario","keyword":"Scenario","steps":[{"name":"configure retry = { count: 5, interval: 0 }","result":{"duration":168219,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"*","line":41},{"name":"url demoBaseUrl","result":{"duration":7609,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"Given","line":42},{"name":"path 'greeting'","result":{"duration":102021,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":43},{"name":"retry until responseStatus == 200 && response.id > 3","result":{"duration":20733,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"And","line":44},{"name":"method get","result":{"duration":30383948,"status":"passed"},"match":{"location":"karate","arguments":[]},"keyword":"When","line":45,"doc_string":{"content_type":"","value":"11:04:59.773 request:\n2 > GET http:\/\/127.0.0.1:51918\/greeting\n2 > Accept-Encoding: gzip,deflate\n2 > Connection: Keep-Alive\n2 > Host: 127.0.0.1:51918\n2 > User-Agent: Apache-HttpClient\/4.5.5 (Java\/1.8.0_181)\n\n11:04:59.776 response time in milliseconds: 3.44\n2 < 200\n2 < Cache-Control: no-cache, no-store, max-age=0, must-revalidate\n2 < Content-Type: application\/json;charset=UTF-8\n2 < Date: Tue, 09 Apr 2019 14:04:59 GMT\n2 < Expires: 0\n2 < Pragma: no-cache\n2 < Transfer-Encoding: chunked\n2 < X-Content-Type-Options: nosniff\n2 < X-Frame-Options: DENY\n2 < X-XSS-Protection: 1; mode=block\n{\"id\":2,\"content\":\"Hello World!\"}\n\n11:04:59.784 retry condition not satisfied: responseStatus == 200 && response.id > 3\n11:04:59.784 sleeping before retry #1\n11:04:59.797 request:\n3 > GET http:\/\/127.0.0.1:51918\/greeting\n3 > Accept-Encoding: gzip,deflate\n3 > Connection: Keep-Alive\n3 > Host: 127.0.0.1:51918\n3 > User-Agent: Apache-HttpClient\/4.5.5 (Java\/1.8.0_181)\n\n11:04:59.801 response time in milliseconds: 3.61\n3 < 200\n3 < Cache-Control: no-cache, no-store, max-age=0, must-revalidate\n3 < Content-Type: application\/json;charset=UTF-8\n3 < Date: Tue, 09 Apr 2019 14:04:59 GMT\n3 < Expires: 0\n3 < Pragma: no-cache\n3 < Transfer-Encoding: chunked\n3 < X-Content-Type-Options: nosniff\n3 < X-Frame-Options: DENY\n3 < X-XSS-Protection: 1; mode=block\n{\"id\":4,\"content\":\"Hello World!\"}\n\n11:04:59.801 retry condition satisfied","line":45}}]}],"name":"demo\/polling\/polling.feature","description":"demo of how to poll until a certain condition is met","id":"demo-of-how-to-poll-until-a-certain-condition-is-met","keyword":"Feature","uri":"demo\/polling\/polling.feature"}]